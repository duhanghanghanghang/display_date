<!-- pages/wardrobe/outfit/outfit.wxml -->
<view class="outfit-container">
  <!-- è™šæ‹Ÿäººç‰©å±•ç¤ºåŒº -->
  <view class="avatar-section">
    <view class="avatar-placeholder">
      <text class="avatar-icon">ğŸ§</text>
      <view class="selected-items-display">
        <view class="selected-item" wx:for="{{Object.values(selectedItems)}}" wx:key="*this" wx:for-item="itemId">
          <text>âœ“</text>
        </view>
      </view>
    </view>
    
    <view class="selection-count">
      å·²é€‰æ‹© {{Object.keys(selectedItems).length}} ä»¶
    </view>
  </view>

  <!-- æ“ä½œæŒ‰é’® -->
  <view class="action-bar">
    <button class="action-btn clear" bindtap="clearSelection">æ¸…ç©º</button>
    <button class="action-btn save" bindtap="showSave">ä¿å­˜æ­é…</button>
  </view>

  <!-- åˆ†ç±»é€‰æ‹©åŒº -->
  <scroll-view class="categories-section" scroll-y>
    <view class="category-block" wx:for="{{categories}}" wx:key="id" wx:for-item="category">
      <view class="category-header">
        <text class="category-name">{{category.name}}</text>
        <text class="category-count">{{allItems[category.id].length}}ä»¶</text>
      </view>
      
      <scroll-view class="items-scroll" scroll-x>
        <view class="item-chip" 
              wx:for="{{allItems[category.id]}}" 
              wx:key="id"
              wx:for-item="item"
              class="{{selectedItems[category.id] === item.id ? 'selected' : ''}}"
              bindtap="selectItem"
              data-category-id="{{category.id}}"
              data-item-id="{{item.id}}">
          <image wx:if="{{item.imageUrl}}" class="chip-image" src="{{item.imageUrl}}" mode="aspectFill" />
          <view wx:else class="chip-placeholder">
            <text>{{item.name.substring(0, 2)}}</text>
          </view>
          <text class="chip-name">{{item.name}}</text>
        </view>
      </scroll-view>
    </view>
  </scroll-view>

  <!-- å·²ä¿å­˜çš„æ­é… -->
  <view class="saved-outfits-section" wx:if="{{savedOutfits.length > 0}}">
    <view class="section-title">æˆ‘çš„æ­é…æ–¹æ¡ˆ</view>
    <scroll-view class="outfits-scroll" scroll-x>
      <view class="outfit-card" wx:for="{{savedOutfits}}" wx:key="id" bindtap="loadOutfit" data-outfit="{{item}}">
        <text class="outfit-name">{{item.name}}</text>
        <text class="outfit-count">{{Object.keys(item.items).length}}ä»¶</text>
        <text class="delete-outfit" catchtap="deleteOutfit" data-id="{{item.id}}">âœ•</text>
      </view>
    </scroll-view>
  </view>
</view>

<!-- ä¿å­˜æ­é…å¼¹çª— -->
<view class="modal-mask" wx:if="{{showSaveDialog}}" catchtap="closeSaveDialog">
  <view class="modal-content" catchtap="">
    <view class="modal-header">
      <text class="modal-title">ä¿å­˜æ­é…</text>
      <text class="modal-close" catchtap="closeSaveDialog">âœ•</text>
    </view>
    
    <view class="modal-body">
      <input 
        class="outfit-input"
        placeholder="è¯·è¾“å…¥æ­é…åç§°ï¼ˆå¦‚ï¼šä¸Šç­é€šå‹¤ï¼‰"
        value="{{outfitName}}"
        bindinput="onOutfitNameInput"
        maxlength="30"
      />
    </view>
    
    <view class="modal-footer">
      <button class="modal-btn cancel" catchtap="closeSaveDialog">å–æ¶ˆ</button>
      <button class="modal-btn confirm" catchtap="saveOutfit">ä¿å­˜</button>
    </view>
  </view>
</view>
